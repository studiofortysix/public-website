{{- /* Basic SEO meta tags for Studio 46 */ -}}

{{- $siteTitle := .Site.Title -}}

{{- /* Determine page title with SEO override support */ -}}
{{- $pageTitle := .Title -}}
{{- with .Params.seo_title }}
  {{- $pageTitle = . -}}
{{- end -}}

{{- if .IsHome }}
  {{- $pageTitle = $siteTitle -}}
{{- end -}}

<title>{{ if .IsHome }}{{ $siteTitle }}{{ else }}{{ $pageTitle }} | {{ $siteTitle }}{{ end }}</title>

{{- /* Build a meta description with sensible fallbacks */ -}}
{{- $description := "" -}}

{{- with .Params.meta_description }}
  {{- $description = . | plainify | htmlUnescape | truncate 155 -}}
{{- end -}}

{{- if and (eq $description "") (isset .Params "description") }}
  {{- $description = .Params.description | plainify | htmlUnescape | truncate 155 -}}
{{- end -}}

{{- if and (eq $description "") .IsHome }}
  {{- with .Site.Params.description }}
    {{- $description = . | plainify | htmlUnescape | truncate 155 -}}
  {{- end -}}
{{- end -}}

{{- if and (eq $description "") (.Summary) }}
  {{- $description = .Summary | plainify | htmlUnescape | truncate 155 -}}
{{- end -}}

{{- if ne $description "" }}
  <meta name="description" content="{{ $description }}">
{{- end -}}

{{- /* Canonical URL (canonical <link> tag is set in head.html) */ -}}
{{- $canonical := cond .IsHome .Site.BaseURL .Permalink -}}

{{- /* Open Graph image logic: page-level override, then site default */ -}}
{{- $image := "" -}}
{{- with .Params.og_image }}
  {{- $image = . | absURL -}}
{{- end -}}

{{- if and (eq $image "") (isset .Site.Params "defaultOgImage") }}
  {{- with .Site.Params.defaultOgImage }}
    {{- $image = . | absURL -}}
  {{- end -}}
{{- end -}}

{{- /* Open Graph tags */ -}}
<meta property="og:type" content="{{ if .IsHome }}website{{ else }}article{{ end }}">
<meta property="og:title" content="{{ $pageTitle }}">
{{- if ne $description "" }}
  <meta property="og:description" content="{{ $description }}">
{{- end -}}
<meta property="og:url" content="{{ $canonical }}">
{{- if ne $image "" }}
  <meta property="og:image" content="{{ $image }}">
{{- end -}}

{{- /* Twitter card tags */ -}}
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="{{ $pageTitle }}">
{{- if ne $description "" }}
  <meta name="twitter:description" content="{{ $description }}">
{{- end -}}
{{- if ne $image "" }}
  <meta name="twitter:image" content="{{ $image }}">
{{- end -}}